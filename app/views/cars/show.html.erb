<h1>Car description</h1>

<li>車両名：<%= @car.car_name %></li>
<li>発売日：<%= @car.launch_date %></li>

<%= link_to "車両情報の編集", edit_car_path(@car)  %>
<%= link_to "車両の削除","/cars/#{@car.id}", data: {turbo_method: :delete}  %>

<%# Calculation register %>
<%= form_with model: [@car, @calculation], local: true do |f| %>
  <div>
    演算名：
    <%= f.text_field :calculation_name %>
  </div>
  <%= f.submit '登録' %>
<% end %>


<%# Calculation List %>
<% @calculations.each do |calculation| %>
  <div class="calculation">
    <li>演算名：<%= calculation.calculation_name %></li>
    <%= link_to "編集", edit_car_calculation_path(car_id: @car, id: calculation.id)%>
    <%= link_to "削除", "/cars/#{@car.id}/calculations/#{calculation.id}", data: {turbo_method: :delete} %>
  </div>
  <div calss="signalinfo">
    <% calculation.signalinfos.each do |signalinfo| %>
      <li>信号名：<%= signalinfo.signal_name %></li>
      <li>信号の種類：<%= signalinfo.signal_type.name %></li>
      <%= link_to "編集", edit_car_calculation_signalinfo_path(car_id: @car, calculation_id: calculation.id, id: signalinfo.id)%>
      <%= link_to "削除", "/cars/#{@car.id}/calculations/#{calculation.id}/signalinfos/#{signalinfo.id}", data: {turbo_method: :delete} %>
    <% end %>
  </div>



  <%# Signal register %>
  <%= form_with(model: Signalinfo.new, url: car_calculation_signalinfos_path(car_id: @car, calculation_id: calculation.id), local: true) do |f| %>
    <div>
      信号名：<%= f.text_field :signal_name %>
    </div>
    <div>
      信号の種類：
      <%= f.collection_select(:signal_type_id, SignalType.all, :id, :name, {})%>
    </div>
    <%= f.hidden_field :calculation_id, value: calculation.id %>
    <%= f.submit "信号を追加" %>
  <% end %>

  <%# Signal trace %>
  <%= link_to "信号の追跡", trace_signals_car_calculation_path(car_id: @car, id: calculation.id) %>

<% end %>

<%= link_to "影響確認",'#'  %>